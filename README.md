# Jena气候数据集时间序列预测

本仓库包含使用Jena气候数据集进行时间序列预测任务的源代码和数据。实验的主要目标是利用深度学习模型，如多层感知机（MLP）、循环神经网络（RNN）、长短期记忆网络（LSTM）和门控循环单元（GRU），基于过去5天的气象数据预测未来24小时的温度。

## 项目概述

Jena气候数据集包含了从2009年1月1日到2016年12月31日的气象数据，数据包括温度、大气压力、湿度、风速等14个特征。数据记录的时间间隔为10分钟，共计420,551条记录。本实验的目标是基于过去5天的数据（1440个时间步），预测接下来24小时的温度。

在本项目中，我们使用了几种深度学习模型进行时间序列预测，并评估它们的表现。模型包括：

- **MLP（多层感知机）**
- **RNN（循环神经网络）**
- **LSTM（长短期记忆网络）**
- **GRU（门控循环单元）**

我们还通过不同的超参数、网络结构和训练策略进行实验，分析它们对模型性能的影响。

## 数据集

- **数据集**：Jena气候数据集（可在Kaggle上获得）
- **时间范围**：2009年1月1日 - 2016年12月31日
- **数据点**：420,551条记录（10分钟间隔）
- **特征**：14个气象特征，包括温度、大气压力、湿度、风速等
- **任务**：基于过去5天的数据预测未来24小时的温度。

## 实验设计

### 1. **基本实验**
- **数据预处理**：对数据集进行标准化处理，使用训练集的均值和标准差对验证集和测试集进行标准化。
- **模型训练**：训练MLP、RNN、LSTM、GRU模型，并记录每个epoch的训练损失和验证集准确率。
- **模型评估**：在验证集上评估每个模型的表现，选择最佳模型在测试集上进行最终评估。
- **结果可视化**：绘制每个模型的训练损失和验证损失曲线。

### 2. **超参数调整**
- **Epoch对比**：通过对比不同训练周期（20、150、300）对RNN模型的影响，记录训练损失和验证损失。
- **网络结构调整**：修改RNN模型，调整网络层数和每层隐藏单元数（例如，2层RNN，每层50个隐藏单元 vs. 15层RNN，每层50个隐藏单元）。
- **学习率对比**：使用不同的学习率（0.1，0.001，0.000001）训练RNN模型，评估学习率对训练过程的影响。

## 模型结构

- **MLP**：
  - 输入：120×14（5天数据，每天144个数据点，14个特征）
  - 隐藏层：256个神经元（ReLU），128个神经元（ReLU）
  - 输出：1个神经元（预测温度）

- **RNN**：
  - 输入：14个特征
  - RNN层：2层，50个隐藏单元
  - 输出：1个神经元（预测温度）

- **LSTM**：
  - 输入：14个特征
  - LSTM层：2层，50个隐藏单元
  - 输出：1个神经元（预测温度）

- **GRU**：
  - 输入：14个特征
  - GRU层：2层，50个隐藏单元
  - 输出：1个神经元（预测温度）

## 如何运行

1. 克隆仓库：
   ```bash
   git clone https://github.com/Gong-sun-bai/RNN_demo.git
   cd RNN_demo
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 准备数据集：
   - 下载 [Jena气候数据集](https://www.kaggle.com/mnassrib/jena-climate) 并将其放入 `data/` 文件夹。

4. 训练模型：
   - 运行每个模型的训练脚本：
     ```bash
     python train_mlp.py
     python train_rnn.py
     python train_lstm.py
     python train_gru.py
     ```

5. 结果：
   - 结果会保存在 `results/` 文件夹中，包括损失曲线和MSE值。

## 结论

本项目旨在探索不同的深度学习模型在时间序列预测中的表现，并评估它们在温度预测任务中的有效性。通过实验不同的超参数和网络配置，目标是找到最适合该任务的模型。

## 许可证

本仓库采用MIT许可证，具体详情请参见 LICENSE 文件。
